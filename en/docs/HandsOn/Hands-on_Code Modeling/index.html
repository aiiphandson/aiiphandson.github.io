<!doctype html>
<html class="docs-version-current" lang="en-US" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="HandsOn RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="HandsOn Atom Feed"><title data-react-helmet="true">5. Hands-on Code Modeling | HandsOn</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/en/docs/HandsOn/Hands-on_Code Modeling"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="5. Hands-on Code Modeling | HandsOn"><meta data-react-helmet="true" name="description" content="Code Modeling"><meta data-react-helmet="true" property="og:description" content="Code Modeling"><link data-react-helmet="true" rel="icon" href="/en/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/en/docs/HandsOn/Hands-on_Code Modeling"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/HandsOn/Hands-on_Code Modeling" hreflang="ko-KR"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/en/docs/HandsOn/Hands-on_Code Modeling" hreflang="en-US"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/HandsOn/Hands-on_Code Modeling" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.feb03a1a.css">
<link rel="preload" href="/en/assets/js/runtime~main.32a85db7.js" as="script">
<link rel="preload" href="/en/assets/js/main.3c8b8e97.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/en/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">My Site</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/docs/HandsOn/Hands-on_Code Modeling" target="_self" rel="noopener noreferrer" class="dropdown__link">Korean</a></li><li><a href="/en/docs/HandsOn/Hands-on_Code Modeling" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/intro">Hands-On (English)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/en/docs/HandsOn/Runtime_Hands_on_AutoML 모델 Runtime 등록 및 배포">HandsOn</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/HandsOn/Runtime_Hands_on_AutoML 모델 Runtime 등록 및 배포">1. AutoML Model Runtime Registration &amp; Serving</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/HandsOn/Runtime_Hands_on_Sandbox 생성 모델 등록">2. Register sandbox creation model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/HandsOn/Runtime_Hands_on_Drift_모니터링">3. Drift Monitoring Registration and Check</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/HandsOn/Runtime_Hands_on_모델해석">4. Model interpretation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/HandsOn/Hands-on_Code Modeling">5. Hands-on Code Modeling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/HandsOn/Hands-on_No Code Modeling">6. AutoML Model Development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/HandsOn/Runtime_Hands-on _시나리오">7.Runtime Hands-on 시나리오</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/HandsOn/Hands-on 분석 시나리오">8. Hands-on 분석 시나리오</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/HandsOn/Hands-on Instruction">9. HandsOn</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>5. Hands-on Code Modeling</h1><p><strong>Code Modeling</strong></p><p>&lt;튜토리얼 목표&gt;</p><ul><li>프로젝트와 워크플로우를 신규로 생성하고, Coding Tool인 <em>SandBox 을 이용하여 데이터 전처리와 모델 개발을 수행합니다. </em>SandBox: 데이터 분석가들이 주로 사용하는 RStudio, Jupyter 에서 데이터 처리 및 분석 작업 할 수 있는 환경을 의미함</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="1-프로젝트-생성">1. 프로젝트 생성<a class="hash-link" href="#1-프로젝트-생성" title="Direct link to heading">​</a></h2><ul><li>먼저 사번으로 로그인을 합니다. 초기 비밀번호는 P@s$w0rd입니다. 처음 로그인하면 새 비밀번호를 설정해야 합니다.</li></ul><p><img alt="/img/HandsOn/codeModeling/1.png" src="/en/assets/images/1-3350a9eed104fc50c88f759b71f37513.png" width="1009" height="587"></p><blockquote><p>새 비밀번호를 입력 후 새로운 비밀번호로 로그인 하세요</p></blockquote><ul><li>대시보드 &gt; 프로젝트에서 <!-- -->[+프로젝트]<!-- --> 버튼을 클릭하여 프로젝트를 신규로 생성합니다. 프로젝트는 팀당 하나씩만 생성해 주세요</li></ul><p><img alt="/img/HandsOn/codeModeling/2.png" src="/en/assets/images/2-777eb8d0a443d84fb73ae3407d768f65.png" width="2365" height="1457"></p><ul><li>대시보드 &gt; 프로젝트 등록에서 프로젝트 필수 정보를 입력하고, 자원 선택 후 <!-- -->[등록하기]<!-- --> 버튼 클릭합니다.</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">이미지 변경 : 원하는 이미지를 선택하세요      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">프로젝트 제목 (필수) : 프로젝트 제목을 입력하세요   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">프로젝트 내용 (필수) : 프로젝트의 내용을 작성하세요   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">프로젝트 사용자 등록 : 프로젝트의 팀원 선택 후 오른쪽 이동 버튼을 클릭하여 추가 후 권한을 Owner로 변경해 주세요    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Livy 선택: 사번이홀수로 끝나면 livy_contest_01, 짝수로 끝나면 livy_contest_02를 선택하세요    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">클러스터 선택 : Default로 놔두세요     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">자원 설정 (필수) : Medium(8Core 16G)를 선택하세요</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><img alt="/img/HandsOn/codeModeling/3.png" src="/en/assets/images/3-ccba1c983252b090168a9deb46018809.png" width="2365" height="1316"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="2-워크플로우-생성">2. 워크플로우 생성<a class="hash-link" href="#2-워크플로우-생성" title="Direct link to heading">​</a></h2><ul><li>[+워크플로우]<!-- --> 버튼을 클릭하여 워크플로우를 신규로 생성합니다.</li></ul><p><img alt="/img/HandsOn/codeModeling/5.png" src="/en/assets/images/4-1f8987cf7c96e7f7154297c69e56d9c3.png" width="2365" height="1071"></p><ul><li>워크플로우 작업선택에서 <!-- -->[Sandbox로 바로가기]<!-- --> 선택 후 우측하단의 <!-- -->[다음]<!-- --> 버튼 클릭합니다.</li></ul><p><img alt="/img/HandsOn/codeModeling/7.png" src="/en/assets/images/5-fb9d5b9cccb07344b087ee6b250b00e1.png" width="2362" height="562"></p><ul><li>Sandbox 분석환경 설정 화면에서 설정 후 우측 하단 <!-- -->[분석환경 생성하기]<!-- --> 버튼을 클릭합니다.<br>&lt; 예시 &gt; <ul><li>분석환경 : Jupyter Lab</li><li>자원설정 : Small</li></ul></li></ul><p><img alt="/img/HandsOn/codeModeling/8.png" src="/en/assets/images/6-1f09d29f009926d3e6281987d02a1504.png" width="2365" height="1188"></p><ul><li>Jupyter 비밀번호 설정 Pop-up 창에서 비밀번호를 입력 후 <!-- -->[등록]<!-- --> 버튼을 클릭합니다.<br>&lt; 예시 &gt; 비밀번호 : abcd1234!</li></ul><p><img alt="/img/HandsOn/codeModeling/9.png" src="/en/assets/images/7-1f30477ac5ddba654f2284f7d3063532.png" width="876" height="975"></p><ul><li>워크플로우에서 우측 패널의 <!-- -->[데이터 가져오기]<!-- --> 를 선택합니다.</li></ul><p><img alt="/img/HandsOn/codeModeling/10.png" src="/en/assets/images/8-5f096635c09d919fb7a94a3108da4e8c.png" width="1301" height="842"></p><ul><li>데이터셋 추가 에서 <!-- -->[Asset]<!-- --> 버튼을 클릭하고, 이후 나타나는 Pop-up 창에서 학습 데이타를 선택하고 <!-- -->[등록]<!-- --> 버튼을 클릭합니다.<br>&lt;예시&gt; 데이터 명 : churn_train</li></ul><p><img alt="/img/HandsOn/codeModeling/11.png" src="/en/assets/images/9-e0d66226cd9297c562b6ac2628fbcabb.png" width="2365" height="1024"></p><ul><li>데이터셋 추가 화면으로 돌아와서 우측 상단의 <!-- -->[추가]<!-- --> 버튼을 클릭합니다.</li></ul><p><img alt="/img/HandsOn/codeModeling/13.png" src="/en/assets/images/10-e72ac1060e3f53945cf9961b4a433d69.png" width="2386" height="773"></p><ul><li>워크플로우에 <!-- -->[데이터 셋]<!-- --> 노드가 정상적으로 생성된 것을 확인하고, 우측 패널의 <!-- -->[데이터 가져오기]<!-- --> 를 클릭하여 동일한 방법으로 Asset 에 있는 예측 데이터를 불러옵니다.<br>&lt;예시&gt; 데이터 명 : churn_test</li></ul><p><img alt="/img/HandsOn/codeModeling/14.png" src="/en/assets/images/11-0bbf0f07ec4ba996d203e249f5a34d36.png" width="2271" height="841"></p><ul><li>워크플로우에서 2개의 <!-- -->[데이터 셋]<!-- --> 노드를 적당한 위치로 옮기고 <!-- -->[Jupyter lab]<!-- --> 노드와 각각 연결합니다. 그리고 <!-- -->[Jupyter lab]<!-- --> 노드를 클릭하면 나타나는 우측 패널에서 상태가 ‘Running’ 인지 확인하고 <!-- -->[접속]<!-- --> 버튼을 클릭합니다.</li></ul><p><img alt="/img/HandsOn/codeModeling/15.png" src="/en/assets/images/12-09b8ed9d837131539042ef49cb71e0f7.png" width="2365" height="1069"></p><ul><li>jupyter notebook 비밀번호를 입력하고 <!-- -->[Log in]<!-- --> 버튼을 클릭합니다.<br>&lt; 예시 &gt;Password : abcd1234!</li></ul><p><img alt="/img/HandsOn/codeModeling/16.png" src="/en/assets/images/13-1e85a47be019c54f1e47d09bc940cae4.png" width="1381" height="307"></p><ul><li>JupyterLab &gt; Launcher 에서 Notebook &gt; Python 3 을 선택하고, 좌측 탐색기에서 dataset 폴더를 더블 클릭하여 데이터 셋이 정상적으로 불러왔는지 확인합니다.</li></ul><p><img alt="/img/HandsOn/codeModeling/17.png" src="/en/assets/images/14-307cdb7c73701e8f765336107f025823.png" width="2138" height="1072"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="3-sandbox-분석-수행">3. Sandbox 분석 수행<a class="hash-link" href="#3-sandbox-분석-수행" title="Direct link to heading">​</a></h2><ul><li>Dataset 폴더 밑에 데이터가 정상적으로 들어있는지 확인하고, jupyter notebook 을 이용하여 Modeling 작업을 수행합니다.</li></ul><p><img alt="/img/HandsOn/codeModeling/18.png" src="/en/assets/images/15-10a9a4952f079530b543c0933c1284ce.png" width="2365" height="795"></p><p>&lt; 예시 &gt; Classification Modeling 작업을 위한 예시 Code</p><ul><li>학습데이타 : churn_train, 예측 데이터 : churn_test, 예측 데이터 결과 : churn_test_pred</li></ul><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## ===========================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">##  LibraryImport</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## ===========================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">impute </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SimpleImputer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ensemble </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> RandomForestClassifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">metrics </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> classification_report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model_selection </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> train_test_split</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> random</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## ===========================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">##  Data Preparation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## ===========================================================  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Data Read</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_trin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./dataset/churn_train.csv&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;CP949&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># 학습 데이터</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./dataset/churn_test.csv&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;CP949&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># 예측 데이터</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Variable Selection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dl_col </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;CustomerId&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Surname&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;BaseYear&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_trin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_trin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dl_col</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dl_col</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Missing Imputation : Known Missing  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_trin</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Balance&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inplace</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Balance&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inplace</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Data Partition : Train -&gt; (Train / Valid)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_trin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df_vald </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> train_test_split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_trin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> train_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> random_state</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## X, Y Split</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_trin_x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_trin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Exited&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_vald_x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_vald</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Exited&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_trin_y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_trin</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Exited&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_vald_y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_vald</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Exited&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## ===========================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">##  Feature Engineering</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## ===========================================================  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## === Numeric Features</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Missing Imputation : &quot;median&quot; </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dl_num_cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_trin_x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_get_numeric_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns                   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SimpleImputer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">missing_values</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> strategy</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;median&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_trin_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_trin_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_trin_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_vald_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_vald_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## === Categoriacl Features </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Missing Imputation : New class       </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dl_cls_cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_trin_x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">select_dtypes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">include</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;object&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tolist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_trin_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_trin_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;missing&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_vald_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_vald_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;missing&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;missing&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## One Hot Encoding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_trin_x_dumy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_dummies</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_trin_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> prefix</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_vald_x_dumy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_dummies</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_vald_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> prefix</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test_dumy   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_dummies</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> prefix</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dl_cls_cols</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_trin_x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df_trin_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df_trin_x_dumy</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_vald_x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df_vald_x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df_vald_x_dumy</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dl_num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df_test_dumy</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## ===========================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">##  Modeling : RandomForest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## ===========================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Fitting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> RandomForestClassifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_estimators</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> random_state</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max_features</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_trin_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df_trin_y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                                                 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Predict     </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_vald_pred </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_vald_x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test_pred </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_test</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Metric </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sk_report </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> classification_report</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">digits</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_true</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">df_vald_y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_pred</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">df_vald_pred</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sk_report</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## Predicted value Export</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test_pred</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Predict_Value&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test_pred</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./dataset/churn_test_pred.csv&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sep</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =============== The End Of Modeling =============== #</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>분석 작업이 모두 완료되면 프로그램을 저장하고, JupyterLab 탐색기에서 예측결과 데이터를 확인합니다. 예측 결과 데이타에서 우측버튼을 클릭하여 Download 를 진행합니다. &lt;예시&gt; 예측 결과 데이터 : churn_test_pred</li></ul><p><img alt="/img/HandsOn/codeModeling/19.png" src="/en/assets/images/16-da1955c7f50826fec131f6d89682ae2f.png" width="2376" height="1267"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="4-결과-dataset-워크플로우-노드로-추출">4. 결과 Dataset 워크플로우 노드로 추출<a class="hash-link" href="#4-결과-dataset-워크플로우-노드로-추출" title="Direct link to heading">​</a></h2><ul><li>Sandbox에서 처리한 데이터셋이나 모델을 워크플로우가 가져온다.</li></ul><p><img alt="/img/HandsOn/codeModeling/20.png" src="/en/assets/images/17-7175c1271650f318076c165b29717747.png" width="2333" height="1278"></p><ul><li>Sandbox노드를 클릭 후, 오른쪽 패널에서 “데이터셋 추출”버튼을 클릭한다.</li></ul><p><img alt="/img/HandsOn/codeModeling/21.png" src="/en/assets/images/18-5e647a39ef44e0e2b4c5568b45e485c5.png" width="2365" height="1478"></p><ul><li>Dataset폴더 아래 결과파일 “Churn_test_pred.csv”에 체크박스 표시 후, 아래에 “워크플로우 추가”버튼을 클릭하면 아래와 같이 Dataset노드가 생성된다.</li></ul><p><img alt="/img/HandsOn/codeModeling/22.png" src="/en/assets/images/19-7de8e94951fdcd26a62fccbe61833024.png" width="2365" height="1438"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/HandsOn/5. Hands-on_Code Modeling.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/en/docs/HandsOn/Runtime_Hands_on_모델해석"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">4. Model interpretation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/en/docs/HandsOn/Hands-on_No Code Modeling"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">6. AutoML Model Development</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-프로젝트-생성" class="table-of-contents__link toc-highlight">1. 프로젝트 생성</a></li><li><a href="#2-워크플로우-생성" class="table-of-contents__link toc-highlight">2. 워크플로우 생성</a></li><li><a href="#3-sandbox-분석-수행" class="table-of-contents__link toc-highlight">3. Sandbox 분석 수행</a></li><li><a href="#4-결과-dataset-워크플로우-노드로-추출" class="table-of-contents__link toc-highlight">4. 결과 Dataset 워크플로우 노드로 추출</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/en/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/en/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.32a85db7.js"></script>
<script src="/en/assets/js/main.3c8b8e97.js"></script>
</body>
</html>